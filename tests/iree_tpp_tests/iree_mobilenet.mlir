// RUN: iree-compile --iree-hal-target-backends=llvm-cpu \
// RUN: %s.frozen.mhlo -o %s.vmfb --iree-input-type=mhlo \
// RUN: --iree-llvmcpu-enable-tpp-lowering-pipeline \
// RUN: --iree-llvmcpu-stack-allocation-limit=4816897

// RUN: iree-run-module --device=local-task --module=%s.vmfb \
// RUN: --function=predict --task_worker_stack_size=481689700 \
// RUN: --input="1x224x224x3xf32=1" | \
// RUN: FileCheck %s

// RUN: rm %s.vmfb

//
// CHECK: EXEC @predict
// CHECK: result[0]: hal.buffer_view
// CHECK: 1x1001xf32=[-0.228928 -1.03166 -0.423655 -0.749672 -0.931061 1.88117 -1.17632 0.119185 0.174726 -0.527139 0.800064 -0.204032 -1.34344 
// CHECK-SAME: -0.732608 -1.06805 -0.347754 0.319403 1.28516 -1.52433 0.571009 -1.44987 -0.723965 2.51324 2.80265 1.76064 0.255489 0.348153 
// CHECK-SAME: 0.483814 -0.33167 0.345239 -1.14948 -0.0141972 0.467665 0.303881 -0.648837 -0.373304 -1.40231 0.153105 -0.333316 -0.118777 -1.3799 
// CHECK-SAME: -0.689244 -0.373204 -0.0848559 -0.0569627 0.6648 -0.811381 0.633568 -1.41829 -0.606295 -1.33292 0.165287 -0.976368 1.1085 1.33026 
// CHECK-SAME: 0.173259 -1.00295 -1.13782 0.611316 -0.933552 -0.0565898 0.0400315 -0.159793 -1.05793 -1.75241 -0.961562 -0.791248 -0.441832 
// CHECK-SAME: -1.87613 0.222551 1.60753 0.192474 1.27047 -0.64533 0.222299 -0.960895 1.58296 0.19658 0.676909 3.30882 1.12583 0.328346 0.202072 
// CHECK-SAME: 0.0340778 0.153329 -0.813594 -0.473974 -1.21715 -1.19933 -0.236184 0.971042 -0.694671 -0.377007 1.19182 -0.250194 -1.75482 -0.825989 
// CHECK-SAME: -0.766286 -1.32411 0.404924 0.97273 0.6993 0.845365 -0.915473 -1.41774 -1.19967 -1.38851 -0.644912 0.420938 0.185773 0.0637423 
// CHECK-SAME: -0.208882 2.16165 1.31088 0.343318 0.294722 -1.4417 -1.33509 -0.609945 -0.983486 -1.38519 -0.348587 -1.86481 -0.97858 -1.94047 
// CHECK-SAME: -0.315874 -0.35946 -1.13623 2.24749 1.06046 1.4907 -1.34048 -1.25884 0.182575 0.551664 0.0662046 0.15371 -0.825831 -0.146143 0.130535 -0.145743 
// CHECK-SAME: -1.28006 0.423349 0.335101 0.411036 1.33939 0.106365 0.935756 -0.28146 0.634347 0.109393 -0.908717 -0.283312 -0.22368 -0.898433 -0.508176 -1.17443 
// CHECK-SAME: -0.0759942 -0.581112 -0.999355 -0.719313 -0.719183 0.452179 -0.511003 0.859984 0.327641 0.0589947 0.77421 0.00507706 0.221161 -0.0816621 -0.958147 
// CHECK-SAME: -0.0362954 0.705368 -0.344368 0.246613 -0.13746 -0.386299 -0.297029 1.49149 -1.03248 -0.805849 -0.204215 0.141372 -0.514582 0.0871788 0.498864 
// CHECK-SAME: -0.422548 0.195343 -0.707014 -1.13687 0.310664 0.649296 -1.45554 -1.02 -0.790164 -0.535166 -0.695621 -0.376597 -0.771933 -0.126556 0.0152455 
// CHECK-SAME: -0.469386 0.616798 -0.680957 -0.731432 0.099689 0.541429 -0.772756 0.395664 1.32888 0.391993 -0.559243 -0.655158 -0.527518 0.348423 0.0945799 
// CHECK-SAME: 0.320192 0.0890932 -0.374648 -0.185474 0.649176 -0.434233 -0.628787 0.788435 0.135606 -0.101542 -1.7793 0.345821 -1.31919 0.309537 -0.299732 
// CHECK-SAME: -1.03734 0.126823 -2.32521 -0.0907463 1.49771 0.926806 -1.57128 0.163829 0.471694 -0.86812 0.965496 -0.129743 -1.14012 -1.28888 0.921544 
// CHECK-SAME: -0.359808 -0.4859 -0.635957 0.530995 -0.369556 0.234865 -0.3899 -1.34959 0.104436 -0.669435 -0.45959 0.0316897 0.924959 -0.761591 -0.691637 
// CHECK-SAME: 0.435633 -0.857857 -0.407101 0.342007 0.0284102 -0.838608 -0.216919 -1.33942 0.540395 1.40581 -1.10789 -0.111269 -0.882012 0.0364984 0.286176 
// CHECK-SAME: -0.140056 -0.250356 -0.136522 1.05314 -0.478433 -0.180919 -0.182437 0.613761 1.15482 0.104837 -1.1221 -0.474921 -1.14023 -0.395287 -0.540972 
// CHECK-SAME: 0.744645 -0.451457 0.878671 0.849261 0.164633 1.66637 -0.7479 -0.530725 -0.210668 -1.16719 2.34135 0.531694 -0.159909 0.0583755 0.411622 
// CHECK-SAME: 1.39895 0.0630757 1.60532 -0.411785 1.87297 0.352977 -0.339332 -0.368174 1.40492 -0.34721 1.35058 0.287678 1.00981 -1.68979 -1.72063 -0.355871 
// CHECK-SAME: -1.55271 -0.775114 -0.32169 -0.881411 -0.867051 0.841501 -0.939221 -0.676992 -0.88653 -0.00479786 -0.6616 0.203137 -1.74856 -1.9642 -0.637579 
// CHECK-SAME: -2.65862 -0.674011 -0.259687 -0.301314 0.0413937 -0.948156 -0.30768 -0.565667 1.26201 0.378637 0.693464 0.778197 0.926806 0.36296 0.0945637 
// CHECK-SAME: -0.460977 0.893764 1.01 -1.0925 -1.08431 -0.847301 -1.22505 -1.19364 -2.42868 -0.934322 -0.29808 -0.455253 -0.506588 -0.533841 0.341241 -0.115395 
// CHECK-SAME: 1.01432 -0.890005 -0.693571 -1.24592 -0.614466 -0.242866 0.573007 -0.470508 -0.502833 -1.8245 -0.664781 -1.55843 -0.376991 -1.48667 -1.24055 
// CHECK-SAME: -1.60368 -1.55868 0.873714 -0.236246 -0.603271 0.0866512 -0.350845 -2.24046 -0.651156 -0.835038 -0.580457 -2.04355 -1.87627 -0.652159 -0.450349 
// CHECK-SAME: 0.00312306 1.93128 0.401844 0.143206 0.919252 -0.268041 0.0186965 1.24199 -2.65573 -1.92209 -0.949578 1.83492 -1.03127 -2.22818 -1.96291 -0.951948 
// CHECK-SAME: -0.0482579 -2.83607 1.11668 0.677777 2.82832 2.32532 -0.990067 0.515731 -0.761403 1.06517 0.492763 0.159239 0.822851 -0.54858 0.204017 -0.265993 
// CHECK-SAME: -0.376703 -0.0546701 -0.382926 0.69613 1.29217 0.172064 0.139336 1.09999 -2.16622 -0.955646 2.43102 1.12648 -0.79236 1.48489 -1.32872 -1.54932 
// CHECK-SAME: 0.25459 0.830418 0.9045 -0.124399 -0.734581 -0.391529 -1.30224 -0.445243 -0.575381 1.01147 -2.84662 0.859896 -1.51492 0.270412 -0.550357 -0.743521 
// CHECK-SAME: 1.0106 -1.48365 0.905767 0.195729 -0.405105 -1.46219 -0.170851 -0.328185 1.51064 -0.858874 -0.454263 1.16611 1.39769 0.246876 -0.520847 -2.14514 
// CHECK-SAME: -0.515416 0.595612 0.0975742 1.28894 -0.204667 -1.17253 1.259 0.461943 0.361541 -0.0160073 3.04157 -0.913998 -0.232486 -0.484808 -0.720695 0.0187775 
// CHECK-SAME: 0.231317 0.524015 0.518344 -1.52392 -0.3556 1.32199 -0.327397 0.780333 -0.1741 0.672156 0.539709 -0.481081 -0.134413 0.656792 1.52297 -1.28245 
// CHECK-SAME: 0.326155 0.0593857 0.26008 -0.504681 0.398623 -0.222937 -0.0290145 3.56942 -0.497629 0.12502 0.995198 -0.771768 -1.82644 -0.121707 -1.81731 -1.6588 
// CHECK-SAME: -1.12242 -0.509615 0.850788 0.567439 1.75102 0.067484 0.268317 0.551468 3.87977 -0.346011 0.83381 1.17986 -0.0661529 0.23602 1.08278 1.00494 1.15904 
// CHECK-SAME:-0.785668 -2.32744 1.38223 -0.898425 -0.267363 -1.20757 3.83897 -1.28145 1.15741 -0.196479 -0.803864 0.793854 -1.17428 1.79849 1.03973 -0.968964 
// CHECK-SAME: 1.21922 -0.477538 -0.364302 0.898415 -1.67946 -0.583605 -1.16497 -1.60153 -1.55814 -0.409525 -1.81422 1.64699 -1.64335 0.130587 0.691697 2.04899 
// CHECK-SAME: -1.02514 0.710867 0.282028 0.244934 0.0506639 -0.859048 -0.963384 -1.28149 0.546027 -0.978948 1.5726 -1.48527 2.37516 -0.294636 0.510478 -0.9341 
// CHECK-SAME: 1.73988 0.539234 2.30752 -0.891351 0.106062 2.94111 -1.56786 -0.640048 0.46479 2.81866 -0.054277 -0.489702 -0.708579 2.46484 0.4009 1.27696 
// CHECK-SAME: -0.0924399 1.76528 -1.15938 2.16939 1.81707 -0.875074 0.516137 -0.877589 1.33801 1.91012 0.561402 -1.12836 1.49022 0.30523 -0.845196 2.32972 
// CHECK-SAME: 0.034285 -1.68327 -0.534474 1.99191 -2.08402 0.099382 1.91744 1.37436 1.057 1.1942 1.52694 0.307957 -0.422898 -0.309377 -1.19648 -1.10628 
// CHECK-SAME: -0.20156 0.366347 0.225634 -0.895096 0.672234 4.65775 0.455021 0.0585701 -0.667211 0.602983 1.29619 1.40212 -0.788674 -0.165273 -0.710166 
// CHECK-SAME: 0.651991 0.69762 -0.456013 -0.531918 -1.24541 -0.799998 -0.070832 -0.172679 0.541237 -1.03738 1.11401 -0.443312 -0.176122 -0.499777 -1.54782 
// CHECK-SAME: -0.912209 0.0157762 -0.770862 0.668613 0.652507 -0.00678897 -2.09195 0.642964 3.33043 -0.1876 -0.728636 2.86609 1.76347 0.282565 1.71593 
// CHECK-SAME: -0.711321 0.288154 -0.131272 -1.81448 -1.70979 0.470993 -0.310531 -0.0859854 -0.303253 -1.56469 1.15059 1.40975 1.43278 -0.123973 -0.693633 
// CHECK-SAME: -0.130318 2.67608 1.55152 -0.639578 -0.401175 -1.39838 -0.737821 -1.32857 -1.27528 0.194074 -2.05823 1.25306 1.7773 -1.90427 0.534454 1.58535 
// CHECK-SAME: -0.899305 0.720739 -1.75781 0.157364 2.18708 3.37251 -1.08859 1.69022 0.181338 0.470637 -1.50177 -1.68725 -1.51832 -2.14266 0.33423 0.103499 
// CHECK-SAME: 1.11755 0.0265705 -0.342759 -1.2716 0.186379 0.280087 1.31591 -1.00829 -1.22168 0.829714 0.828208 0.0461794 -1.35407 -0.119558 0.376932 3.08836 
// CHECK-SAME: 1.10143 -1.3327 0.560921 0.785261 -2.19169 -0.790028 2.41759 -1.75661 1.52507 -0.0582347 -1.1289 -1.90819 0.956313 2.17668 1.41101 -0.522 0.263637 
// CHECK-SAME: -0.584572 -0.455652 -1.86048 2.12693 -0.484248 2.40556 -0.363502 -0.383462 1.78735 2.08 -1.00921 -0.440062 -0.175287 -2.20588 0.171626 -0.979848 
// CHECK-SAME: 0.132786 -0.514617 0.393972 5.37156 1.99029 -1.65328 0.0466886 -2.19055 -0.417133 1.728 -2.76242 -0.426032 0.679645 -0.354739 1.55836 -0.867522 
// CHECK-SAME: -0.501273 -0.229926 0.0411156 -0.342566 -1.42723 -0.114845 1.09755 -0.190567 1.44684 0.654947 1.1187 -0.649712 0.79298 -1.10613 0.432681 1.49898 
// CHECK-SAME: 1.46437 0.598739 -1.04804 -0.396089 -3.43055 -1.37772 2.9508 0.00845971 0.158527 -1.18992 0.028683 0.162086 0.566563 0.438734 1.49023 -0.779583 
// CHECK-SAME: 1.39094 0.377348 -1.88098 0.958211 0.395157 -1.34287 0.920828 -0.945727 0.278494 0.922742 0.461168 -1.09271 -0.490233 0.873814 -0.0568702 -0.944722 
// CHECK-SAME: 4.10039 2.75079 1.42527 0.0457841 -1.98344 -1.48379 0.885522 1.19256 2.2118 0.107675 0.830519 1.08333 -0.483712 -0.233532 1.00319 -0.537698 -0.188427 
// CHECK-SAME: 1.00864 0.053013 0.738597 0.128734 -0.642825 -0.483324 -1.41736 -2.13718 0.0308887 -0.427179 -1.10522 1.22153 -0.0692707 -0.451181 -1.33107 -0.78896 
// CHECK-SAME: -1.19762 0.252272 1.94939 -0.305412 0.485241 1.25867 0.614475 -1.03092 3.82107 -1.59495 -0.623776 0.531316 -0.986631 -1.4093 -1.14884 4.94841 0.787559 
// CHECK-SAME: 0.555242 1.50551 2.14911 1.34619 0.867694 -0.280004 0.0889855 -1.19527 1.22866 1.2306 1.14457 1.1196 -0.500015 0.306355 1.87984 -0.0665512 1.06036 
// CHECK-SAME: 1.18428 0.262759 2.84593 0.587275 -0.305047 1.12247 -0.24393 0.207276 0.0187192 1.24456 -1.07563 0.330032 -0.884547 -0.832824 -1.02331 -0.102174 
// CHECK-SAME: -0.923374 -1.33493 1.63244 -1.50299 -0.030199 0.332949 -1.34759 -1.204 -0.719815 -0.21185 1.14542 -0.263957 -1.23312 -0.884662 -0.551178 -0.0698826 
// CHECK-SAME: -0.647385 -0.837872 1.87801 -0.64888 -1.84325 1.60725 1.02449 0.949077 1.02298 -0.204047 -1.33709 1.42188 -0.416997 -0.668491 0.682035 2.05593 -0.289841 
// CHECK-SAME: -0.380432 0.00109741 -1.19436 -1.09539 -1.01698 -0.67561 1.77749 1.18114 3.0538 0.599127 -0.892315 2.9758 0.387998 -0.545331 1.15764 0.737268 0.14466 
// CHECK-SAME: 1.2557 0.623799 -0.302636 0.189822 -0.380593 -0.28173 1.35033 2.46742 1.5558 -0.854879 1.10992 -0.145009 -0.774361 1.07734 0.493478 -0.816583 -0.389173 
// CHECK-SAME: -1.62331 -0.0484858 0.0937512 -1.2104 -0.0744901 1.70566]
//